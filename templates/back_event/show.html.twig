{% extends 'base_back.html.twig' %}

{% block title %}Event{% endblock %}

{% block body %}
    <div class="rounded-2 bg-white p-3">
        <div class="d-flex justify-content-between">
            <h1>Evento <span class="fs-4 ps-2"># {{ event.id }}</span></h1>
            <img src="{{ asset('images/card.png') }}" class="rounded-2" alt="..." width="70" height="70">
        </div>

        <table class="table">
            <tbody>
            <tr>
                <th>Nombre</th>
                <td>{{ event.name }}</td>
            </tr>
            <tr>
                <th>Descripcion</th>
                <td>{{ event.description }}</td>
            </tr>
            <tr>
                <th>Fecha del evento</th>
                <td>{{ event.date ? event.date|date('Y-m-d') : '' }}</td>
            </tr>
            <tr>
                <th>Fecha de publicacion</th>
                <td>{{ event.created ? event.created|date('Y-m-d') : '' }}</td>
            </tr>
            <tr>
                <th>Localizacion</th>
                <td>{{ event.location }}</td>
            </tr>
            <tr>
                <th>Estado</th>
                <td>{{ event.state }}</td>
            </tr>
            </tbody>
        </table>

        <div class="rounded-2 p-3 bg-2 text-white mt-4">
            <h2>Detalles del evento</h2>

            <div class="rounded-2 p-2 bg-white">
                {% if event.details is not empty %}
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Instrumento requerido</th>
                            <th>Pago mínimo</th>
                            <th>Cantidad</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for detail in event.details %}
                            <tr>
                                <td>{{ detail.requiredInstrument.name }}</td>
                                <td>{{ detail.minPayment }}</td>
                                <td>{{ detail.quantity }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <p>No se encontraron detalles para este evento.</p>
                {% endif %}
            </div>
        </div>

        <div class="text-center d-flex mt-3">
            <button class="w-100 button-back-1" data-bs-toggle="modal" data-bs-target="#deleteModal{{ event.id }}">
                <i class="fa fa-trash"></i>
            </button>
            <a href="{{ path('app_back_event_index') }}" class="w-100 button-back-2">
                <i class="fa fa-list"></i>
            </a>
            <a href="{{ path('app_back_event_edit', {'id': event.id}) }}" class="w-100 button-back-3">
                <i class="fa fa-pencil"></i>
            </a>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal fade" id="deleteModal{{ event.id }}" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="deleteModalLabel{{ event.id }}" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="deleteModalLabel{{ event.id }}">Confirmar Eliminación</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    ¿Estás seguro de que deseas eliminar este evento?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <form method="post" action="{{ path('app_back_event_delete', {'id': event.id}) }}">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ event.id) }}">
                        <button type="submit" class="btn btn-danger">Eliminar</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
